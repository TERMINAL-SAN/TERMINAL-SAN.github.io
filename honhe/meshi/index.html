<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="js/modernizr.custom.js"></script>
    <script src="js/jquery.dlmenu.js"></script>
    <link rel="stylesheet" type="text/css" href="css/default.css" />
    <link rel="stylesheet" type="text/css" href="css/component.css" />
<!--    <script type="text/javascript" src="js/jquery-2.1.1.js"></script> -->
    <script type="text/javascript" src="js/jquery-ui.js"></script>
    <script type="text/javascript" src="js/jquery.balloon.js"></script>
    <script type="text/javascript" src="js/holiday.js"></script>
    
<title>HP</title>
<link rel="stylesheet" type="text/css" href="./css/sample.css" media="tv,screen,print">
<style type="text/css">
body{
	margin: 0;
	padding: 60px 0 0 0;
}
* html body{
	overflow: hidden;
} 
div#headerArea {
	position: fixed !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 60px;
	background-color: white;
	color: #fff;
    border-bottom:double;
    border-bottom-color:#8A0829;
    border-top:double;
    border-top-color:#8A0829;
}
div#footerArea {
	position: fixed !important;
	position: absolute;
	bottom: 0;
	left: 0;
	width: 100%;
	height: 0px;
	background-color: #4E9ABE;
	color: #fff;
}
* html div#contentsArea{
	height: 100%;
	overflow: auto;
    background-color:#A9F5F2;
}
div.infobox {
    height: 7.8em;
    overflow: scroll;
    border: red 1px dashed;
    background-color: #fff0f0;
}
span.date {
    font-size:13px;
    padding:0 5px;

}
span.newinfo {
    font-size:12px;
    
}
div.infoborder {
    border-bottom:dashed;
    border-width:1px;
    border-color:#F7819F;
    word-wrap:break-word;
}
</style>
</head>
<body style="background-image:url(images/renga.png);">
<div id="headerArea">
<img src="images/meshilogo.png" width="50%" style="position:absolute; left:70px; top:10px;">
<A href="../index.html"><img src="images/home.png" height="100%" style="position:absolute; right:0;"></A>
<div id="dl-menu" class="dl-menuwrapper">
        <button class="dl-trigger">Open Menu</button>
        <ul class="dl-menu">
            
            <li><!--start-->
                <a href="http://terminalsan.blog.fc2.com/">ブログ</a>
            </li><!--end-->
            <li><!--start-->
                <a href="">ツール</a>
                <ul class="dl-submenu">
                    <li><a href="">Sub-Item 1</a></li>
                    <li><a href="">Sub-Item 2</a></li>
                    <li><a href="">Sub-Item 3</a></li>
                    <li>
                        <a href="">Sub-Item 4</a>
                        <ul class="dl-submenu">
                            <li><a href="#">Sub-Sub-Item 1</a></li>
                            <li><a href="#">Sub-Sub-Item 2</a></li>
                            <li><a href="#">Sub-Sub-Item 3</a></li>
                        </ul>
                    </li>
                </ul>
            </li><!--end-->
            <li><!--start-->
                <a href="">アクセス</a>
                <ul class="dl-submenu">
                    <li><a href="http://twitter.com/aiaignition">Twitter</a></li>
                    <li><a href="">Mail</a></li>
                </ul>
            </li><!--end-->



        </ul>
    </div><!-- /dl-menuwrapper -->

</div>
<div id="contentsArea" style="background-image:url(images/renga.png); background-color:white; padding:25px 13px 35px 13px; min-height:device-height;">
    <div id="SpringboadArea"
        style="
        padding:10px 10px 10px 10px;
        border:double;
        border-radius: 20px;
        -webkit-border-radius: 20px;
        -moz-border-radius: 20px;
        background-color:white;
        ">
    <center><img src="images/imadoko.png" style="padding:40px;" onclick="imadoko();"></center>
    <!--検索ゾーンstart-->
    <div id="searchTable" style="display:none;">
    
    <center><span onclick="test();" style="border:solid; padding:3px 3px 3px 3px;">検索する</span></center>
    </br>
    <div id="resultTable" style="text-align:center;">
    </div><!--resultTable-->
    
    
    
    </div><!--searchTable-->
    <!--検索ゾーンend-->
    
    </div><!--SpringboadArea終わり-->
</div>
<script>
    $(function() {
      $( '#dl-menu' ).dlmenu();
      });
      
      function imadoko(){
          if(document.getElementById("searchTable").style.display == "none"){
          document.getElementById("searchTable").style.display = "block";
          }else{
          document.getElementById("searchTable").style.display = "none";
          }
      }

function test(){
    //まず全部読み込む
    var tenpo = [];
    var result_tenpo = [];
    var count = 0;
    var Dayoff1;
    var Dayoff2;
    
    $.ajax({
       type: 'GET',
       url: 'json/tenpo.json',
       dataType: 'json',
       success: function(json){
       for(var key in json){
       tenpo[key] = {
           "name": json[key].name,
           "type": json[key].type,
           "open": json[key].open,
           "close": json[key].close,
           "open2": json[key].open2,
           "close2": json[key].close2,
           "Holi_open": json[key].Holi_open,
           "Holi_close": json[key].Holi_close,
           "Holi_open2": json[key].Holi_open2,
           "Holi_close2": json[key].Holi_close2,
           "Ord_2flag": json[key].Ord_2flag,
           "Holi_2flag": json[key].Holi_2flag,
           "Sun": json[key].Sun,
           "Mon": json[key].Mon,
           "Tue": json[key].Tue,
           "Wed": json[key].Wed,
           "Thu": json[key].Thu,
           "Fri": json[key].Fri,
           "Sat": json[key].Sat,
           "Restday": json[key].Restday,
           "Address": json[key].Address,
       };
        }//格納終了

           //現在の時刻を取得
           var Nowymdhms　=　new Date();
           var NowYear = Nowymdhms.getYear();
           var NowMon = Nowymdhms.getMonth() + 1;
           var NowDay = Nowymdhms.getDate();
           var NowWeek = Nowymdhms.getDay();
           var NowHour = Nowymdhms.getHours();
           var NowMin = Nowymdhms.getMinutes();
           var NowSec = Nowymdhms.getSeconds();
           var Week = new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");
           if(NowHour < 10){
           NowHour = "0"+NowHour;
           }
           if(NowMin < 10){
           NowMin = "0"+NowMin;
           }
           var time ="" + NowHour + NowMin;
   //       var time = "0100";
           //時刻取得終わり

           //検索準備
            //現在が第何の何曜日なのかを取得する
           var today = new Date();
           var numberOfweek = "" + Math.floor((today.getDate() + 6 ) / 7);//何週目か記録
            //現在が祝日であるかどうかを取得する
           var isRest;//1なら祝日、0なら平日or休日
           var holidayname = amaitortedays.isNationalHoliday();
           if(holidayname == null){
           isRest = "0";
           }else{
           isRest = "1";
           }
           
           
           
           //検索開始
           for(var i in tenpo){
           //定休日でないかどうかを確認、定休日ならDayoff1に1が入る
           switch (NowWeek){
           case 0:
           if( (tenpo[i].Sun.indexOf(numberOfweek) != -1) || (tenpo[i].Sun == "H")){
           Dayoff1 = 1;
           }
           break;
           case 1:
           if( (tenpo[i].Mon.indexOf(numberOfweek) != -1) || (tenpo[i].Mon == "H")){
           Dayoff1 = 1;
           }
           break;
           case 2:
           if( (tenpo[i].Tue.indexOf(numberOfweek) != -1) || (tenpo[i].Tue == "H")){
           Dayoff1 = 1;
           }
           break;
           case 3:
           if( (tenpo[i].Wed.indexOf(numberOfweek) != -1) || (tenpo[i].Wed == "H")){
           Dayoff1 = 1;
           }
           break;
           case 4:
           if( (tenpo[i].Thu.indexOf(numberOfweek) != -1) || (tenpo[i].Thu == "H")){
           Dayoff1 = 1;
           }
           break;
           case 5:
           if( (tenpo[i].Fri.indexOf(numberOfweek) != -1) || (tenpo[i].Fri == "H")){
           Dayoff1 = 1;
           }
           break;
           case 6:
           if( (tenpo[i].Sat.indexOf(numberOfweek) != -1) || (tenpo[i].Sat == "H")){
           Dayoff1 = 1;
           }
           break;
           }

           //祝日休みでないかどうかを確認、祝日休みならDayoff2に1が入る
           if(isRest == "1"){
           if(isRest == tenpo[i].Restday){
           Dayoff2 = 1;
           }
           }
           
           //前述の二つの条件をOR回路で出力する
           //どちらも0(つまり定休日ではない)なら処理を開始する
        if((Dayoff1 != 1) && (Dayoff2 != 1)){
           var Holi_open;
           var Holi_close;
           var Holi_open2;
           var Holi_close2;
           var open;
           var close;
           var open2;
           var close2;
           
           //数値の準備
           if(time.indexOf("0") == 0){//0900などの先頭に0が付く場合
           time = time.slice(-3);//数値化
           }

           if(tenpo[i].Holi_open.indexOf("0") == 0){//0900などの先頭に0が付く場合
           Holi_open = tenpo[i].Holi_open.slice(-3);//数値化
           }else{
           Holi_open = tenpo[i].Holi_open;//普通に代入
           }
           if(tenpo[i].Holi_open2.indexOf("0") == 0){//0900などの先頭に0が付く場合
           Holi_open2 = tenpo[i].Holi_open2.slice(-3);//数値化
           }else{
           Holi_open2 = tenpo[i].Holi_open2;//普通に代入
           }
           if(tenpo[i].Holi_close.indexOf("0") == 0){//0900などの先頭に0が付く場合
           Holi_close = tenpo[i].Holi_close.slice(-3);//数値化
           }else{
           Holi_close = tenpo[i].Holi_close;//普通に代入
           }
           if(tenpo[i].Holi_close2.indexOf("0") == 0){//0900などの先頭に0が付く場合
           Holi_close2 = tenpo[i].Holi_close2.slice(-3);//数値化
           }else{
           Holi_close2 = tenpo[i].Holi_close2;//普通に代入
           }
           if(tenpo[i].open.indexOf("0") == 0){//0900などの先頭に0が付く場合
           open = tenpo[i].open.slice(-3);//数値化
           }else{
           open = tenpo[i].open;//普通に代入
           }
           if(tenpo[i].open2.indexOf("0") == 0){//0900などの先頭に0が付く場合
           open2 = tenpo[i].open2.slice(-3);//数値化
           }else{
           open2 = tenpo[i].open2;//普通に代入
           }
           if(tenpo[i].close.indexOf("0") == 0){//0900などの先頭に0が付く場合
           close = tenpo[i].close.slice(-3);//数値化
           }else{
           close = tenpo[i].close;//普通に代入
           }
           if(tenpo[i].close2.indexOf("0") == 0){//0900などの先頭に0が付く場合
           close2 = tenpo[i].close2.slice(-3);//数値化
           }else{
           close2 = tenpo[i].close2;//普通に代入
           }
        
           if((NowWeek == 0) || (NowWeek == 6) || (isRest == "1")){//休日の場合の処理開始↓
           if(tenpo[i].Holi_2flag == "1"){//open2などが存在する場合
           
           if((time >= Holi_open && time < Holi_close) || (time >= Holi_open2 && time < Holi_close2)){
           result_tenpo[count] = tenpo[i];
           count++;
            }
           }else{//open2などが存在しない場合(通常処理)
           var closetime;
           if(Holi_close > 2400){//深夜あるときのの処理
           closetime = Holi_close - 2400;
           if(time < Holi_open && time > closetime){//時間外
           }else{
           result_tenpo[count] = tenpo[i];
           count++;
           }
           }else{//深夜ないときの処理
           closetime = Holi_close;
           if(time >= Holi_open && time < closetime){
           result_tenpo[count] = tenpo[i];
           count++;
           }
           }
           
           }
           }else{//休日の場合の処理終了↑ 平日の場合の処理開始↓
           if(tenpo[i].Ord_2flag == "1"){//open2などが存在する場合
           if((time >= open && time < close) || (time >= open2 && time < close2)){
           result_tenpo[count] = tenpo[i];
           count++;
           }
           }else{//open2などが存在しない場合
           var closetime;
           var closetime;
           if(Holi_close > 2400){//深夜あるときのの処理
           closetime = close - 2400;
           if(time < open && time > closetime){//時間外
           }else{
           result_tenpo[count] = tenpo[i];
           count++;
           }
           }else{//深夜ないときの処理
           closetime = close;
           if(time >= open && time < closetime){
           result_tenpo[count] = tenpo[i];
           count++;
           }
           }
           }
           }
           }
           }
           
           document.getElementById('resultTable').innerHTML = "";
           result_tenpo.forEach(function(element,index) {
                                
                                　 /*（1）Pタグの要素ノードオブジェクト*/
                                　 var resultTable = document.getElementById('resultTable');
                                　 /*（2）新たにH1タグの要素ノードを作成する*/
                                　 var pNode = document.createElement('p');
                                　 /*（3）新たにテキストノードを作成する*/
                                　 var textNode = document.createTextNode(element.name);
                                　 /*（4）作成したテキストノードをH1タグ要素の子要素として追加する*/
                                　 pNode.appendChild(textNode);
                                　 /*（1）Pタグに、完成したH1タグを追加する*/
                                　 resultTable.appendChild(pNode);
                                });//出力用
           
           result_tenpo.forEach(function(element,index) {
                                if(window.console) console.log('data[' + index + ']: ' + element.name);
                                });//コンソール用

           
           //document.getElementById("resultTable").innerHTML = result_tenpo;
           

    }
    });//ajax終わり

}

</script>

</body></html>